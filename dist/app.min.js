angular.module("avUi",[]),jQuery.fn.flash=function(a,b,c){var d=this.css("color"),e=this.css("background-color"),f=this;"true"!==f.attr("is-flashing")&&(f.attr("is-flashing","true"),f.css("background-color",b).css("color",a).css("display","inline-block").fadeOut(0).fadeIn(c,"swing",function(){f.css("background-color",e).css("color",d),f.attr("is-flashing","false")}))},angular.module("avUi").directive("avAffixBottom",["$window","$timeout","$parse",function(a,b,c){var d="affix-bottom",e=function(a,b,c){var e=!1,f=$(c).height();($("body").height()+f>window.innerHeight||b.forceAffixWidth&&window.innerWidth<b.forceAffixWidth)&&(e=d),b.affixed!==e&&(b.affix=e,b.setIsAffix(a,e),c.removeClass("hidden"),e?(c.addClass(d),$(c).parent().css("margin-bottom",f+"px")):(c.removeClass(d),$(c).parent().css("margin-bottom",b.defaultBottomMargin)))};return{restrict:"EAC",link:function(d,f,g){function h(){j=b(function(){b.cancel(j),e(d,i,f,g)},100)}var i={affix:!1,getIsAffix:null,setIsAffix:angular.noop,defaultBottomMargin:f.css("margin-bottom"),forceAffixWidth:parseInt(g.forceAffixWidth,10)};g.avAffixBottom.length>0&&(i.getIsAffix=c(g.avAffixBottom),i.setIsAffix=i.getIsAffix.assign);var j;h(),angular.element(a).on("resize",h),angular.element(document.body).on("resize",h),angular.element(f).on("resize",h)}}}]),angular.module("avUi").directive("avAffixTop",["$window","$timeout",function(a,b){var c=function(a,b){$(b.avAffixTop).css("margin-top",$(a).height()+"px")};return{restrict:"EAC",link:function(d,e,f){function g(){h=b(function(){b.cancel(h),c(e,f)},100)}c(e,f);var h;angular.element(e).bind("resize",g),angular.element(a).bind("resize",g)}}}]),angular.module("avUi").directive("avCollapsing",["$window","$timeout",function(a,b){var c=function(a,b){var c=angular.element(a.maxHeightSelector).css("max-height"),d=angular.element(b),e=d[0].scrollHeight;if(-1===c.indexOf("px"))return void console.log("invalid non-pixels max-height for "+a.maxHeightSelector);if(c=parseInt(c.replace("px","")),e>c){if(a.isCollapsed)return;a.isCollapsed=!0,d.addClass("collapsed"),angular.element(a.toggleSelector).removeClass("hidden in")}else{if(!a.isCollapsed)return;a.isCollapsed=!1,d.removeClass("collapsed"),angular.element(a.toggleSelector).addClass("hidden")}},d=function(a,b){var c=angular.element(b);a.isCollapsed?(c.removeClass("collapsed"),angular.element(a.toggleSelector).addClass("in")):(c.addClass("collapsed"),angular.element(a.toggleSelector).removeClass("in")),a.isCollapsed=!a.isCollapsed};return{restrict:"EAC",link:function(e,f,g){function h(){j=b(function(){b.cancel(j),c(k,f,g)},100)}function i(){d(k,f,g)}var j,k={isCollapsed:!1,maxHeightSelector:g.avCollapsing,toggleSelector:g.toggleSelector};h(),angular.element(a).bind("resize",h),angular.element(f).bind("resize",h),angular.element(k.toggleSelector).bind("click",i)}}}]),angular.module("avUi").directive("avRecompile",["$compile","$parse",function(a,b){"use strict";function c(a){return angular.element("<a></a>").append(a.clone()).html()}return{scope:!0,compile:function(d){var e=c(d);return function(c,d,f){var g=c.$parent.$watch(f.avRecompile,function(h,i){var j=f.hasOwnProperty("useBoolean");if((!j||h&&"false"!==h)&&(j||h&&h!==i)){j&&b(f.kcdRecompile).assign(c.$parent,!1);var k=a(e)(c.$parent);d.replaceWith(k),g(),c.$destroy()}})}}}}]),angular.module("avCrypto",[]),angular.module("avCrypto").service("RandomService",function(){return Random}),angular.module("avCrypto").service("DeterministicJsonStringifyService",function(){function a(b){var c;if(Array.isArray(b)){var d=[];for(c=0;c<b.length;c++)d.push(a(b[c]));return"["+d.join(", ")+"]"}if("object"==typeof b){if(null==b)return"null";var e=Object.keys(b).sort(),f=[];for(c=0;c<e.length;c++){var g=e[c],h=b[g];g=JSON.stringify(g),h=a(h),f.push(g+": "+h)}return"{"+f.join(", ")+"}"}return JSON.stringify(b)}return a}),angular.module("avCrypto").service("BigIntService",function(){return BigInt}),angular.module("avCrypto").service("SjclService",function(){return sjcl}),angular.module("avCrypto").service("ElGamalService",function(){return ElGamal}),angular.module("avCrypto").service("EncryptAnswerService",["ElGamalService","BigIntService","RandomService","DeterministicJsonStringifyService",function(a,b,c){return function(d){var e=d,f=a.PublicKey.fromJSONObject(e);return{encryptAnswer:function(d,e,g){var h=new a.Plaintext(b.fromInt(d),f,!0);e=e?b.fromInt(e):c.getRandomInteger(f.q),g=g?b.fromInt(g):c.getRandomInteger(f.q);var i=a.encrypt(f,h,e),j=h.proveKnowledge(i.alpha,e,a.fiatshamir_dlog_challenge_generator,g),k=i.toJSONObject(),l=j.toJSONObject(),m={alpha:k.alpha,beta:k.beta,commitment:l.commitment,response:l.response,challenge:l.challenge};return m},getPublicKey:function(){return d},verifyPlaintextProof:function(c){var d=new a.Ciphertext(b.fromInt(c.alpha),b.fromInt(c.beta),f),e=new a.DLogProof(new a.PlaintextCommitment(b.fromInt(c.alpha),b.fromInt(c.commitment)),b.fromInt(c.challenge),b.fromInt(c.response));return d.verifyPlaintextProof(e,a.fiatshamir_dlog_challenge_generator)}}}}]),angular.module("avCrypto").service("HmacService",["SjclService",function(a){function b(b,c){var d=a.codec.utf8String.toBits(b),e=new a.misc.hmac(d,a.hash.sha256).mac(c);return a.codec.hex.fromBits(e)}function c(a,b){for(var c=a.length,d=b.length,e=c===d?1:0,f=c;f--;){var g=a.charCodeAt(f%c),h=b.charCodeAt(f%d),i=g===h;e&=i}return 1===e}return{checkHmac:function(a,d,e){return c(b(a,d),e)},hmac:b,equal:c}}]),angular.module("avCrypto").service("AnswerEncoderService",["DeterministicJsonStringifyService",function(a){function b(a,b){for(var c=a.toString(10),d=c,e=0;e<b-c.length;e++)d="0"+d;return d}var c=a;return function(a,d){var e={validCodecs:["APPROVAL","MEEK-STV"],numAvailableOptions:d,encode:function(a){var c=(d+2).toString(10).length,e=_.reduceRight(a,function(a,d){return b(d,c)+a},"");return 0===e.length&&(e=b(d+2,c)),parseInt(e,10)},decode:function(a){var b,c=a.toString(10),e=c.length,f=(d+2).toString(10).length,g=(f-e%f)%f,h=[];if(parseInt(c,10)===d+2)return[];for(b=0;g>b;b++)c="0"+c;for(b=0;b<c.length/f;b++){var i=c.substr(b*f,f),j=parseInt(i,10);h.push(j)}return h},sanityCheck:function(a){try{var b=_.times(d,function(a){return a+1});void 0!==a&&(b=_.pluck(a.answers,"id"));for(var f=0;10>f;f++){for(var g=[],h=Math.ceil(1e4*Math.random())%b.length,i=0;h>i;i++){var j=Math.ceil(1e4*Math.random())%b.length,k=b[j];-1===_.indexOf(g,k)&&g.push(k)}var l=e.encode(g),m=c(e.decode(l));if(c(g)!==m)return!1}var n=e.encode([]),o=c(e.decode(n));if(c([])!==o)return!1}catch(p){return!1}return!0}},f=[e],g=_.find(f,function(b){return _.contains(b.validCodecs,a)});if(!g)throw"unknown answer encoding service requested: "+a;return g}}]),angular.module("avCrypto").service("CastBallotService",["ConfigService","EncryptAnswerService","moment","SjclService","DeterministicJsonStringifyService","ElGamalService","AnswerEncoderService","$timeout","$http",function(a,b,c,d,e,f,g,h,i){function j(a){var b=m(a),c=d.hash.sha256.hash(b);return d.codec.hex.fromBits(c)}function k(a,b){var c=_.filter(a.answers,function(a){return a.selected>-1}),d=_.sortBy(c,function(a){return a.selected}),e=_.pluck(d,"id"),f=g(a.tally_type,a.answers.length),h=f.encode(e);if(b){var i=f.decode(h);if(m(e)!==m(i))return null}return h}function l(a,b){for(var d={a:"encrypted-vote-v1",proofs:[],choices:[],issue_date:c().format(),election_hash:{a:"hash/sha256/value",value:a.hash}},e=0;e<a.questions.length;e++){var f=b[e];d.proofs.push({commitment:f.commitment,response:f.response,challenge:f.challenge}),d.choices.push({alpha:f.alpha,beta:f.beta})}return d}var m=e;return function(a){function c(){if(s>=e)return void h(d(),a.delay);o=a.election.questions[s],q=Math.floor(100*s*n/(e*n+1)),5>q&&(q=5),a.statusUpdate("encryptingQuestion",{questionNum:s,percentageCompleted:q});var g=b(a.election.pubkeys[s]),i=k(o,!0);if(!i)return void a.error("errorEncoding","error while encoding the answer to a question");console.log("plaintext = "+i);var j=g.encryptAnswer(i);return f.push(j),a.verify&&(q=Math.floor((100*s*n+1)/(e*n+1)),5>q&&(q=5),a.statusUpdate("verifyingQuestion",{questionNum:s,percentageCompleted:q}),!g.verifyPlaintextProof(j))?void a.error("errorEncrypting","error while encrypting the answer to a question"):(s+=1,void h(c,a.delay))}function d(){var b=l(a.election,f),c=(m(b),j(b));a.statusUpdate("sendingBallot",{ballotHash:c,ballot:angular.copy(b),percentageCompleted:Math.floor(100*e*n/(e*n+1))}),i.post(a.castBallotUrl,b,{headers:{Authorization:a.authorizationHeader}}).success(function(b){a.success(b)}).error(function(b){a.error("couldntSendBallot",m(b))})}if(!angular.isObject(a))throw"invalid input data, not an object";if(!angular.isDefined(a.error)||!angular.isFunction(a.error))throw"data.error is not a function";if(!angular.isDefined(a.success)||!angular.isFunction(a.success))return void a.error("invalidDataFormat","data.success is not a function");if(!angular.isDefined(a.statusUpdate)||!angular.isFunction(a.statusUpdate))return void a.error("invalidDataFormat","data.statusUpdate is not a function");if(!angular.isDefined(a.election)||!angular.isObject(a.election))return void a.error("invalidDataFormat","invalid data.election, not an object");if(!angular.isDefined(a.verify))return void a.error("invalidDataFormat","invalid data.verify");a.verify=!!a.verify;var e=a.election.questions.length,f=[],n=1;a.verify&&(n=2),a.statusUpdate("sanityChecks",{percentageCompleted:0});var o,p,q,r=!0,s=0;try{for(s=0;e>s;s++)if(o=a.election.questions[s],p=g(o.tally_type,o.answers.length),!p.sanityCheck(a.election.questions[s])){r=!1;break}}catch(t){r=!1}return r?(s=0,void h(c,a.delay)):void a.error("sanityChecksFailed","we have detected errors when doing some sanity automatic checks which prevents to assure that you can vote with this web browser. This is most likely a problem with your web browser.")}}]),angular.module("agora-core-view",["ui.bootstrap","ui.utils","ui.router","jm.i18next","ngAnimate","ngResource","ngSanitize","angularMoment","avConfig","avUi","avBooth","avTest","avCrypto"]),angular.module("jm.i18next").config(["$i18nextProvider",function(a){a.options={useCookie:!1,useLocalStorage:!1,fallbackLng:"en",resGetPath:"/locales/__lng__.json",defaultLoadingValue:""}}]),angular.module("agora-core-view").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(a){a.state("booth",{url:"/election/:id/vote/:hmac/:message",templateUrl:"avBooth/booth.html",controller:"BoothController"}),a.state("test-hmac",{url:"/test_hmac/:key/:hmac/:message",templateUrl:"test/test_hmac.html",controller:"TestHmacController"}),a.state("unit-test-e2e",{url:"/unit-test-e2e",templateUrl:"test/unit_test_e2e.html",controller:"UnitTestE2EController"})}]),angular.module("agora-core-view").run(["$rootScope",function(a){a.safeApply=function(b){var c=a.$$phase;"$apply"===c||"$digest"===c?b&&"function"==typeof b&&b():this.$apply(b)},a.$on("$stateChangeStart",function(){console.log("change start"),$("#angular-preloading").show()}),a.$on("$stateChangeSuccess",function(){console.log("change success"),$("#angular-preloading").hide()})}]),angular.module("avBooth",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("avBooth").config(["$stateProvider",function(){}]),angular.module("avBooth").controller("BoothController",["$scope","$stateParams","$filter","ConfigService","$i18next",function(a,b,c,d,e){a.electionId=b.id,a.hmacHash=b.hmac,a.hmacMessage=b.message,a.baseUrl=d.baseUrl,a.config=c("json")(d),a.checkElectionUrl=function(){var b=/^[0-9a-f]{64}$/,c=e("avBooth.errorElectionUrl");if(!b.test(a.hmacHash)||"string"!==$.type(a.hmacMessage))return c;var d=a.hmacMessage.split(":");return 3!==d.length||!b.test(d[0])||isNaN(parseInt(d[1]))||isNaN(parseInt(d[2]))?c:null}}]),angular.module("avBooth").directive("avbAccordionOption",function(){return{restrict:"E",templateUrl:"avBooth/accordion-option-directive/accordion-option-directive.html"}}),angular.module("avBooth").directive("avbAccordionOptions",function(){var a=function(a){var b=_.groupBy(a.options,"category"),c=!0;a.categories=_.map(_.pairs(b),function(a){var b=c===!0;return c=!1,{title:a[0],options:a[1],isOpen:b}})};return{restrict:"E",scope:!0,link:a,templateUrl:"avBooth/accordion-options-directive/accordion-options-directive.html"}}),angular.module("avBooth").directive("avbAccordionSelectedOption",function(){return{restrict:"E",templateUrl:"avBooth/accordion-selected-option-directive/accordion-selected-option-directive.html"}}),angular.module("avBooth").directive("avbAvailableOptions",["$filter",function(a){var b=function(b){function c(a){return a.replace(/á/g,"a").replace(/é/g,"e").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ñ/g,"n")}function d(a){if(!b.filter)return!0;var d=c(a.value.toLowerCase()),e=c(b.filter.toLowerCase());return d.indexOf(e)>-1}function e(){b.filteredOptions=a("filter")(b.options,d)}_.each(b.options,function(a){void 0===a.selected&&(a.selected=-1)}),b.toggleSelectItem=function(a){if(a.selected>-1)a.selected=-1;else{var c=_.filter(b.options,function(a){return a.selected>-1}).length;if(c===b.max)return void $("#maxSelectedLimitReached").flash("white","#0081B9",200);a.selected=c}},b.$watch("filter",e),e()};return{restrict:"E",scope:{max:"=",min:"=",options:"=",layout:"=",autoSelectAnother:"=",filter:"@"},link:b,templateUrl:"avBooth/available-options-directive/available-options-directive.html"}}]),angular.module("avBooth").directive("avBooth",["$resource","$location",function(a){function b(b,c,d){function e(a,c){console.log("setting state to "+a),b.state=a,b.stateData=c,b.stateChange++}function f(a,c){var d=b.election.layout;if("normal"!==d&&"drafts-election"===d)return void b.setState(k.draftsElectionScreen,{isLastQuestion:!0,reviewMode:!0,filter:""});var e=b.election.questions[a],f={"MEEK-STV":k.multiQuestion,APPROVAL:k.multiQuestion},g=f[e.tally_type];b.setState(g,{question:b.election.questions[a],questionNum:a,isLastQuestion:b.election.questions.length===a+1,reviewMode:c,filter:""})}function g(){var a=[k.multiQuestion];b.state===k.startScreen?f(0,!1):b.state===k.reviewScreen?b.setState(k.castingBallotScreen,{}):b.state===k.castingBallotScreen?b.setState(k.successScreen,{ballotHash:b.stateData.ballotHash}):b.stateData.isLastQuestion||b.stateData.reviewMode?b.setState(k.reviewScreen,{}):_.contains(a,b.state)&&!b.stateData.isLastQuestion&&f(b.stateData.questionNum+1,!1)}function h(a){b.setState(k.errorScreen,{error:a})}function i(){b.setState(k.helpScreen,{oldState:{name:b.state,data:angular.copy(b.stateData)}})}function j(){return b.state!==k.helpScreen?void console.log("error, calling to backFromHelp in another state"):void b.setState(b.stateData.oldState.name,b.stateData.oldState.data)}var k={receivingElection:"receivingElection",errorScreen:"errorScreen",helpScreen:"helpScreen",startScreen:"startScreen",multiQuestion:"multiQuestion",draftsElectionScreen:"draftsElectionScreen",reviewScreen:"reviewScreen",castingBallotScreen:"castingBallotScreen",successScreen:"successScreen"};if(angular.extend(b,{election:null,setState:e,stateEnum:k,stateChange:0,showError:h,launchHelp:i,backFromHelp:j,goToQuestion:f,next:g,stateData:{},ballotClearText:[],config:angular.fromJson(b.configStr)}),d.preCheck){var l=b.preCheck();if(null!==l)return void h(l)}e(k.receivingElection,{});try{a(b.electionUrl,{},{get:{method:"GET"}}).get().$promise.then(function(a){b.election=a,b.ballotClearText=_.map(b.election.questions,function(){return[]}),b.setState(k.startScreen,{})},function(){h("error loading the election")})}catch(m){h("error loading the election")}}return{restrict:"E",scope:{electionUrl:"@",castBallotUrl:"@",authorizationHeader:"@",configStr:"@config",preCheck:"&"},link:b,templateUrl:"avBooth/booth-directive/booth-directive.html"}}]),angular.module("avBooth").directive("avbBusy",["$resource","$window",function(){function a(a,b,c){a.updateTitle=function(){var a=b.find(".avb-busy-title"),c=-a.height()-45,d=-a.width()/2;a.attr("style","margin-top: "+c+"px; margin-left: "+d+"px")},a.$watch(c.title,function(){a.updateTitle()})}return{restrict:"E",scope:{},link:a,transclude:!0,templateUrl:"avBooth/busy-directive/busy-directive.html"}}]),angular.module("avBooth").directive("avbCastingBallotScreen",["$i18next","CastBallotService","$timeout",function(a,b,c){function d(d,e){function f(b,c){"sanityChecks"===b?(d.updateTitle(a("avBooth.statusExecutingSanityChecks",{percentage:c.percentageCompleted})),d.percentCompleted=c.percentageCompleted):"encryptingQuestion"===b?(d.updateTitle(a("avBooth.statusEncryptingQuestion",{questionNum:c.questionNum+1,percentage:c.percentageCompleted})),d.percentCompleted=c.percentageCompleted):"verifyingQuestion"===b?(d.updateTitle(a("avBooth.statusVerifyingQuestion",{questionNum:c.questionNum+1,percentage:c.percentageCompleted})),d.percentCompleted=c.percentageCompleted):"sendingBallot"===b&&(d.updateTitle(a("avBooth.sendingBallot",{percentage:c.percentageCompleted})),d.stateData.ballotHash=c.ballotHash,d.percentCompleted=c.percentageCompleted)}d.updateTitle=function(a){var b=e.find(".avb-busy-title").html(a),c=-b.height()-45,d=-b.width()/2;b.attr("style","margin-top: "+c+"px; margin-left: "+d+"px")};var g=500;c(function(){b({election:d.election,statusUpdate:f,authorizationHeader:d.authorizationHeader,castBallotUrl:d.castBallotUrl,success:function(){d.updateTitle(a("avBooth.ballotCast",{percentage:100})),d.percentCompleted=100,d.next()},error:function(a,b){d.showError("couldntSendBallot"===a?"error sending the ballot. "+b:"unknown error casting th ballot. "+b)},verify:!1,delay:g})},g)}return{restrict:"E",link:d,templateUrl:"avBooth/casting-ballot-screen-directive/casting-ballot-screen-directive.html"}}]),angular.module("avBooth").directive("avbDraftOption",function(){return{restrict:"E",templateUrl:"avBooth/draft-option-directive/draft-option-directive.html"}}),angular.module("avBooth").directive("avbDraftOptions",["$filter",function(a){var b=function(b){function c(a){return a.replace(/á/g,"a").replace(/é/g,"e").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ñ/g,"n")}function d(a){if(!b.stateData.filter)return!0;var d=c(a.title.toLowerCase()),e=c(b.stateData.filter.toLowerCase());return d.indexOf(e)>-1}function e(){b.filteredOptions=a("filter")(b.flatOptions,d)}b.$watch("stateData.filter",e),e()};return{restrict:"E",link:b,templateUrl:"avBooth/draft-options-directive/draft-options-directive.html"}}]),angular.module("avBooth").directive("avbSimpleOption",function(){return{restrict:"E",templateUrl:"avBooth/simple-option-directive/simple-option-directive.html"}}),angular.module("avBooth").directive("avbSimpleSelectedOption",function(){return{restrict:"E",templateUrl:"avBooth/simple-selected-option-directive/simple-selected-option-directive.html"}}),angular.module("avBooth").directive("avbDraftsElectionScreen",["$i18next","$filter","$interpolate","$timeout",function(a,b,c,d){var e=function(c){c.warningEnum={selectMoreOpts:"selectMoreOpts",maxSelectedLimitReached:"maxSelectedLimitReached",alreadySelectedAPack:"alreadySelectedAPack",optionInCategoryAlreadySelected:"optionInCategoryAlreadySelected",cantSelectNormalOptionPackAlreadySelected:"cantSelectNormalOptionPackAlreadySelected",cantSelectPackNormalOptionAlreadySelected:"cantSelectPackNormalOptionAlreadySelected"},c.stateData.affixIsSet=!1,c.stateData.affixDropDownShown=!1,c.toggleSelectItem=function(a){var b=c.getSelection();if(a.isPack){if(a.selected>-1)a.selected=-1;else{if(b.length>0&&b[0].isPack)return c.showWarning(c.warningEnum.alreadySelectedAPack);if(b.length>0)return c.showWarning(c.warningEnum.cantSelectPackNormalOptionAlreadySelected);a.selected=0}_.each(a.suboptions,function(b){b.selected=a.selected}),c.updateSelectionWarnings()}else{if(a.selected>-1)a.selected=-1;else{var d=_.filter(b,function(b){return!b.isPack&&b.category===a.category}).length>0;if(b.length>0&&b[0].isPack)return c.showWarning(c.warningEnum.cantSelectNormalOptionPackAlreadySelected);if(d)return c.showWarning(c.warningEnum.optionInCategoryAlreadySelected);a.selected=0}c.updateSelectionWarnings()}},c.getSelection=function(){return b("avbSelectedOptions")(c.flatOptions)},c.showWarning=function(a){c.shownWarning===a?$("#"+a).flash("white","#0081B9",200):(c.shownWarning=a,d(function(){$("#"+a).flash("white","#0081B9",200)},150))},c.allOptions=_.reduce(c.election.questions,function(a,b){var c=_.map(b.answers,function(a){return a.category=b.description,a.title=a.value,void 0===a.selected&&(a.selected=-1),a});return _.union(a,c)},[]);var e=_.groupBy(c.allOptions,"value"),f=_.filter(_.pairs(e),function(a){return a[1].length===c.election.questions.length}),g={title:a("avBooth.completePacksTitle"),isPack:!0,isOpen:!0,options:_.map(f,function(a){var b=-1;return void 0!==a[1][0].selected&&(b=a[1][0].selected),{title:a[0],isPack:!0,isOpen:!1,isOpen2:!1,media_url:a[1][0].media_url,selected:b,details:a[1][0].details,suboptions:a[1]}})},h=_.pluck(g.options,"title"),i=_.filter(c.allOptions,function(a){return!_.contains(h,a.value)}),j=_.groupBy(i,"category");c.categories=_.map(_.pairs(j),function(a){return{title:a[0],isPack:!1,isOpen:!1,isOpen2:!1,options:a[1]}}),c.categories.unshift(g),c.flatOptions=_.flatten(_.pluck(c.categories,"options")),c.numSelectedOptions=function(){return _.filter(c.allOptions,function(a){return a.selected>-1}).length},c.showNext=function(){return c.numSelectedOptions()<c.election.min?void $("#selectMoreOptsWarning").flash("white","#d9534f",200):void c.next()},c.flashWarning=function(a){console.log(a)},c.shownWarning="",c.updateSelectionWarnings=function(){var a=b("avbSelectedOptions")(c.flatOptions),d=[c.warningEnum.maxSelectedLimitReached,c.warningEnum.alreadySelectedAPack,c.warningEnum.cantSelectNormalOptionPackAlreadySelected];if(0===a.length)c.shownWarning=c.warningEnum.selectMoreOpts;else if(1===a.length&&a[0].isPack){if(_.contains(d,c.shownWarning))return;c.shownWarning=c.warningEnum.maxSelectedLimitReached}else a.length<c.election.max?c.shownWarning="":a.length===c.election.max&&(c.shownWarning=c.warningEnum.maxSelectedLimitReached)},c.updateSelectionWarnings()};return{restrict:"E",link:e,templateUrl:"avBooth/drafts-election-screen-directive/drafts-election-screen-directive.html"}}]),angular.module("avBooth").directive("avbErrorScreen",["$resource","$window",function(){return{restrict:"E",templateUrl:"avBooth/error-screen-directive/error-screen-directive.html"}}]),angular.module("avBooth").directive("avbHelpScreen",["ConfigService",function(a){function b(b){b.helpInfo=a.help.info}return{restrict:"E",link:b,templateUrl:"avBooth/help-screen-directive/help-screen-directive.html"}}]),angular.module("avBooth").directive("avbMultiQuestion",function(){var a=function(a){a.stateData.affixIsSet=!1,a.stateData.affixDropDownShown=!1,a.numSelectedOptions=function(){return _.filter(a.election.questions[a.stateData.questionNum].answers,function(a){return a.selected>-1}).length},a.questionNext=function(){return a.numSelectedOptions()<a.stateData.question.min?void $("#selectMoreOptsWarning").flash("white","#d9534f",200):void a.next()}};return{restrict:"E",link:a,templateUrl:"avBooth/multi-question-directive/multi-question-directive.html"}}),angular.module("avBooth").directive("avbReviewBallot",function(){return{restrict:"E",templateUrl:"avBooth/review-ballot-directive/review-ballot-directive.html"}}),angular.module("avBooth").directive("avbReviewScreen",function(){return{restrict:"E",templateUrl:"avBooth/review-screen-directive/review-screen-directive.html"}}),angular.module("avBooth").directive("avbSelectedOptions",function(){var a=function(a){a.toggleSelectItem=function(b){if(b.selected>-1)b.selected=-1;else{var c=_.filter(a.options,function(a){return a.selected>-1}).length;if(c===a.max)return;b.selected=c}}};return{restrict:"E",scope:{max:"=",min:"=",options:"=",layout:"=",sorted:"="},link:a,templateUrl:"avBooth/selected-options-directive/selected-options-directive.html"}}),angular.module("avBooth").directive("avbDraftSelectedOption",function(){return{restrict:"E",templateUrl:"avBooth/draft-selected-option-directive/draft-selected-option-directive.html"}}),angular.module("avBooth").directive("avbStartScreen",function(){return{restrict:"E",scope:!0,templateUrl:"avBooth/start-screen-directive/start-screen-directive.html"}}),angular.module("avBooth").directive("avbSuccessScreen",["ConfigService","$interpolate",function(a,b){function c(c){var d=b(a.success.text);c.successText=d({ballotHash:c.stateData.ballotHash})}return{restrict:"E",link:c,templateUrl:"avBooth/success-screen-directive/success-screen-directive.html"}}]),angular.module("avBooth").filter("avbSelectedOptions",function(){return function(a){var b=_.filter(a,function(a){return a.selected>-1});return _.sortBy(b,function(a){return a.selected})}}),angular.module("avTest",[]),angular.module("avTest").controller("TestHmacController",["$scope","$stateParams","HmacService","amMoment",function(a,b,c){a.hmac=b.hmac,a.message=b.message,a.key=b.key,a.calculatedHmac=c.hmac(b.key,b.message),a.hmacIsValid=c.checkHmac(b.key,b.message,b.hmac);var d="<unset>",e="<unset>",f="<unset>",g="",h=b.message.split(":");3!==h.length?g="(Invalid message, it should follow this format: voterId:electionId:timestamp)":(d=h[0],e=""+parseInt(h[1]),f=""+parseInt(h[2])),a.voterId=d,a.electionId=e,a.timestamp=f,a.timeago=moment(f,"X").fromNow(),a.messageInvalid=g}]),angular.module("avTest").controller("UnitTestE2EController",["$scope","$location","ConfigService",function(a,b,c){c.debug&&(a.html=b.search().html,console.log(b.search()))}]),angular.module("agora-core-view").run(["$templateCache",function(a){"use strict";a.put("avBooth/accordion-option-directive/accordion-option-directive.html",'<div class=opt-data ng-click=toggleSelectItem(option)><h4 class=show-value>{{option.value}}</h4><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div><p class=details>{{option.details}}</p></div><a class="btn btn-default btn-right" href={{option.urls[0].url}} target=_blank>{{option.urls[0].title}}</a>'),a.put("avBooth/accordion-options-directive/accordion-options-directive.html",'<div ng-if="filter.length == 0" class=accordion-mode><accordion close-others=true><accordion-group ng-repeat="category in categories" is-open=category.isOpen ng-class="{\'in\': category.isOpen}"><accordion-heading>{{category.title}} <span class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': category.isOpen, \'glyphicon-chevron-right\': !category.isOpen}"></span></accordion-heading><avb-accordion-option ng-repeat="option in category.options" class=animate-repeat ng-class="{selected: option.selected > -1}"></avb-accordion-option></accordion-group></accordion></div><div ng-if="filter.length > 0" class=filter-mode><avb-accordion-option ng-repeat="option in filteredOptions" class=animate-repeat ng-class="{selected: option.selected > -1}"></avb-accordion-option><div class="animate-repeat padded-left" ng-if="filteredOptions.length == 0" ng-i18next=avBooth.noResults></div></div>'),a.put("avBooth/accordion-selected-option-directive/accordion-selected-option-directive.html",'<div class=opt-data ng-click=toggleSelectItem(option)><h4 class=show-value>{{option.value}}</h4><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div><p class=details>{{option.details}}</p></div><a class="btn btn-default btn-right" href={{option.urls[0].url}} target=_blank>{{option.urls[0].title}}</a>'),a.put("avBooth/available-options-directive/available-options-directive.html",'<div class=col-xs-12 ng-if="layout === \'simple\'"><avb-simple-option ng-repeat="option in filteredOptions" class=animate-repeat ng-class="{selected: option.selected > -1}" ng-click=toggleSelectItem(option)></avb-simple-option><div class="animate-repeat padded-left" ng-if="filteredOptions.length == 0" ng-i18next=avBooth.noResults></div></div><div class=col-xs-12 ng-if="layout === \'accordion\'"><avb-accordion-options></avb-accordion-options></div>'),a.put("avBooth/booth-directive/booth-directive.html",'<div av-recompile=stateChange><avb-busy ng-if="state == stateEnum.receivingElection"><p ng-i18next=avBooth.loadingElectionTitle></p></avb-busy><avb-error-screen ng-if="state == stateEnum.errorScreen"></avb-error-screen><avb-help-screen ng-if="state == stateEnum.helpScreen"></avb-help-screen><avb-start-screen ng-if="state == stateEnum.startScreen"></avb-start-screen><avb-multi-question ng-if="state == stateEnum.multiQuestion"></avb-multi-question><avb-drafts-election-screen ng-if="state == stateEnum.draftsElectionScreen"></avb-drafts-election-screen><avb-review-screen ng-if="state == stateEnum.reviewScreen"></avb-review-screen><avb-casting-ballot-screen ng-if="state == stateEnum.castingBallotScreen"></avb-casting-ballot-screen><avb-success-screen ng-if="state == stateEnum.successScreen"></avb-success-screen></div>'),a.put("avBooth/booth.html","<av-booth election-url={{baseUrl}}election/{{electionId}} cast-ballot-url={{baseUrl}}ballotbox/cast authorization-header={{hmacMessage}}:{{hmacHash}} config={{config}} pre-check=checkElectionUrl()></av-booth>"),a.put("avBooth/busy-directive/busy-directive.html","<div class=avb-busy-title ng-transclude></div><div class=avb-busy-loading></div>"),a.put("avBooth/casting-ballot-screen-directive/casting-ballot-screen-directive.html",'<div class=avb-busy-percent style="width: {{percentCompleted}}%"></div><div class=avb-busy-title></div><div class=avb-busy-loading></div>'),a.put("avBooth/draft-option-directive/draft-option-directive.html",'<div ng-if=option.isPack><div class=opt-data ng-click=toggleSelectItem(option)><img src={{option.media_url}} alt={{option.title}} class="img-rounded"><h4 class=show-value>{{option.title}}</h4><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div><span class="label label-default" ng-i18next=avBooth.packLabel></span><p class=details>{{option.details}}</p></div><button class="btn btn-default btn-right" ng-class="{\'in\': option.isOpen}" ng-click="option.isOpen = !option.isOpen"><span class=glyphicon ng-class="{\'glyphicon-chevron-up\': option.isOpen, \'glyphicon-chevron-down\': !option.isOpen}"></span></button><div class=documents-list ng-class="{\'hidden\': !option.isOpen}"><h4 ng-i18next=avBooth.listOfDraftDocuments></h4><a class=get-document ng-repeat="suboption in option.suboptions" href={{suboption.urls[0].url}} target=_blank>{{suboption.category}} <span class="glyphicon glyphicon-cloud-download pull-right"></span></a></div></div><div ng-if=!option.isPack><div class=opt-data ng-click=toggleSelectItem(option)><img src={{option.media_url}} alt={{option.value}} class="img-rounded"><h4 class=show-value>{{option.value}}</h4><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div><span class="label label-default">{{option.category}}</span><p class=details>{{option.details}}</p></div><a class="btn btn-default btn-right btn-link" href={{option.urls[0].url}} target=_blank><span class="glyphicon glyphicon-cloud-download"></span></a></div>'),a.put("avBooth/draft-options-directive/draft-options-directive.html",'<div class=col-xs-12><div ng-if="stateData.filter.length === 0" class=accordion-mode><accordion close-others=true><accordion-group ng-repeat="category in categories" is-open=category.isOpen class=animate-repeat ng-class="{\'in\': category.isOpen}"><accordion-heading>{{category.title}} <span class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': category.isOpen, \'glyphicon-chevron-right\': !category.isOpen}"></span></accordion-heading><avb-draft-option ng-repeat="option in category.options" class=animate-repeat ng-class="{selected: option.selected > -1}"></avb-draft-option></accordion-group></accordion></div><div ng-if="stateData.filter.length > 0" class=filter-mode><avb-draft-option ng-repeat="option in filteredOptions" class=animate-repeat ng-class="{selected: option.selected > -1}"></avb-draft-option><div class="animate-repeat padded-left" ng-if="filteredOptions.length == 0" ng-i18next=avBooth.noResults></div></div></div>'),a.put("avBooth/draft-selected-option-directive/draft-selected-option-directive.html",'<div ng-if=option.isPack><div class=opt-data ng-click=toggleSelectItem(option)><img src={{option.media_url}} alt={{option.title}} class="img-rounded"><h4 class=show-value>{{option.title}}</h4><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div><span class="label label-default" ng-i18next=avBooth.packLabel></span><p class=details>{{option.details}}</p></div><button class="btn btn-default btn-right" ng-class="{\'in\': option.isOpen2}" ng-click="option.isOpen2 = !option.isOpen2"><span class=glyphicon ng-class="{\'glyphicon-chevron-up\': option.isOpen2, \'glyphicon-chevron-down\': !option.isOpen2}"></span></button><div class=documents-list ng-class="{\'hidden\': !option.isOpen2}"><h4 ng-i18next=avBooth.listOfDraftDocuments></h4><a class=get-document ng-repeat="suboption in option.suboptions" href={{suboption.urls[0].url}} target=_blank>{{suboption.category}} <span class="glyphicon glyphicon-cloud-download pull-right"></span></a></div></div><div ng-if=!option.isPack class=filter-active><div class=opt-data ng-click=toggleSelectItem(option)><img src={{option.media_url}} alt={{option.value}} class="img-rounded"><h4 class=show-value>{{option.value}}</h4><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div><span class="label label-default">{{option.category}}</span><p class=details>{{option.details}}</p></div><a class="btn btn-default btn-right btn-link" href={{option.urls[0].url}} target=_blank><span class="glyphicon glyphicon-cloud-download"></span></a></div>'),a.put("avBooth/drafts-election-screen-directive/drafts-election-screen-directive.html",'<nav class="navbar navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"><div class=pull-left ng-i18next="[i18next]({sprintf:[\'2\',\'3\']})avBooth.stepNumber"></div><div class=pull-right><span class="glyphicon glyphicon-question-sign" ng-click=launchHelp()></span></div></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-drafts-election-screen #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1>{{election.pretty_name}}</h1><p>{{election.description}}</p></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content"><div class=container><div class=row><div class="visible-xs col-xs-12 small-selected padded" ng-class="{dropdown: stateData.affixDropDownShown}"><div class=pull-left ng-click="stateData.affixDropDownShown = !stateData.affixDropDownShown"><h4 class=text-brand-success ng-i18next="[i18next]({count: numSelectedOptions()})avBooth.numSelectedOptionsSmall"></h4><span class="text-brand-success glyphicon glyphicon-play avb-toggle-span"></span></div><div class="pull-right filter-input" ng-class="{hidden: stateData.affixDropDownShown}"><div class="pull-right filter-input"><input type=text class=filter-input id=filter-input ng-model=stateData.filter ng-model-options="{debounce: 500}" ng-i18next="[placeholder]avBooth.filterOptionsPlaceholder"> <span class="glyphicon glyphicon-search"></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="pull-left padded-left hidden-xs"><h4 class=text-brand-success ng-i18next=avBooth.questionAvailableOptionsTitle></h4></div><div class="pull-right filter-input hidden-xs"><input type=text class=filter-input id=filter-input ng-model=stateData.filter ng-model-options="{debounce: 500}" ng-i18next="[placeholder]avBooth.filterOptionsPlaceholder"> <span class="glyphicon glyphicon-search"></span></div><avb-draft-options ng-class="{hidden: stateData.affixIsSet && stateData.affixDropDownShown}"></avb-draft-options></div><div class="col-xs-12 col-sm-6 padded" ng-class="{hidden: stateData.affixIsSet && !stateData.affixDropDownShown, affixedSelection: stateData.affixIsSet}"><h4 class="text-brand-success padded-left" ng-i18next="[i18next]({count: numSelectedOptions()})avBooth.questionSelectedOptionsTitle"></h4><avb-draft-selected-option ng-repeat="option in flatOptions | avbSelectedOptions" class=animate-repeat ng-class="{selected: option.selected > -1}"></avb-draft-selected-option><div class=padded ng-if="(flatOptions | avbSelectedOptions).length == 0" ng-i18next=avBooth.noOptionsSelected></div></div></div><div class="row hidden" ng-cloak av-affix-bottom=stateData.affixIsSet data-force-affix-width=768><p><span class=text-brand-warning id=selectMoreOptsWarning ng-i18next="[i18next]({min: election.min})avBooth.selectMoreOpts" ng-if="shownWarning === warningEnum.selectMoreOpts"></span> <span class=text-brand-primary id=maxSelectedLimitReached ng-i18next="[i18next]({max: election.max})avBooth.maxSelectedLimitReached" ng-if="shownWarning === warningEnum.maxSelectedLimitReached"></span> <span class=text-brand-warning id=alreadySelectedAPack ng-i18next=avBooth.alreadySelectedAPack ng-if="shownWarning === warningEnum.alreadySelectedAPack"></span> <span class=text-brand-warning id=optionInCategoryAlreadySelected ng-i18next=avBooth.optionInCategoryAlreadySelected ng-if="shownWarning === warningEnum.optionInCategoryAlreadySelected"></span> <span class=text-brand-warning id=cantSelectNormalOptionPackAlreadySelected ng-i18next=avBooth.cantSelectNormalOptionPackAlreadySelected ng-if="shownWarning === warningEnum.cantSelectNormalOptionPackAlreadySelected"></span> <span class=text-brand-warning id=cantSelectPackNormalOptionAlreadySelected ng-i18next=avBooth.cantSelectPackNormalOptionAlreadySelected ng-if="shownWarning === warningEnum.cantSelectPackNormalOptionAlreadySelected"></span></p><button class="btn btn-block btn-lg btn-success btn-plain" ng-i18next=avBooth.continueButton ng-click=showNext()></button></div></div></div>'),a.put("avBooth/error-screen-directive/error-screen-directive.html",'<nav class="navbar navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-multi-question #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1 ng-i18next=avBooth.errorTitle></h1></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content"><div class=container><p>{{statusData.error}}</p><span ng-i18next="[html:i18next]({email: config.contact.email, error: stateData.error})avBooth.errorHtml"></span></div></div>'),a.put("avBooth/help-screen-directive/help-screen-directive.html",'<nav class="navbar navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"><div class=pull-right><span class="glyphicon glyphicon-remove-sign" ng-click=backFromHelp()></span></div></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-help-screen #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1 ng-i18next=avBooth.helpTitle></h1><p ng-i18next=avBooth.helpText></p></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content"><div class=container><div class=row><div class=col-xs-12 ng-bind-html=helpInfo></div></div><div class="row hidden" ng-cloak av-affix-bottom data-force-affix-width=768><button class="btn btn-block btn-lg btn-success btn-plain" ng-i18next=avBooth.goBack ng-click=backFromHelp()></button></div></div></div>'),a.put("avBooth/multi-question-directive/multi-question-directive.html",'<nav class="navbar navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"><div class=pull-left ng-i18next="[i18next]({sprintf:[\'2\',\'3\', stateData.questionNum+1, election.questions.length]})avBooth.stepAndQuestionNumber"></div><div class=pull-right><span class="glyphicon glyphicon-question-sign" ng-click=launchHelp()></span></div></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-multi-question #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1>{{stateData.question.question}}</h1><p>{{stateData.question.description}}</p></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content"><div class=container><div class=row><div class="visible-xs col-xs-12 small-selected padded" ng-class="{dropdown: stateData.affixDropDownShown}"><div class=pull-left ng-click="stateData.affixDropDownShown = !stateData.affixDropDownShown"><h4 class=text-brand-success ng-i18next="[i18next]({count: numSelectedOptions()})avBooth.numSelectedOptionsSmall"></h4><span class="text-brand-success glyphicon glyphicon-play avb-toggle-span"></span></div><div class="pull-right filter-input" ng-class="{hidden: stateData.affixDropDownShown}"><div class="pull-right filter-input"><input type=text class=filter-input id=filter-input ng-model=stateData.filter ng-model-options="{debounce: 500}" ng-i18next="[placeholder]avBooth.filterOptionsPlaceholder"> <span class="glyphicon glyphicon-search"></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="pull-left padded-left hidden-xs"><h4 class=text-brand-success ng-i18next=avBooth.questionAvailableOptionsTitle></h4></div><div class="pull-right filter-input hidden-xs"><input type=text class=filter-input id=filter-input ng-model=stateData.filter ng-model-options="{debounce: 500}" ng-i18next="[placeholder]avBooth.filterOptionsPlaceholder"> <span class="glyphicon glyphicon-search"></span></div><avb-available-options layout=stateData.question.layout max=stateData.question.max min=stateData.question.min options=stateData.question.answers filter={{stateData.filter}} ng-class="{hidden: stateData.affixIsSet && stateData.affixDropDownShown}"><avb-available-options></avb-available-options></avb-available-options></div><div class="col-xs-12 col-sm-6 padded" ng-class="{hidden: stateData.affixIsSet && !stateData.affixDropDownShown, affixedSelection: stateData.affixIsSet}"><h4 class="text-brand-success padded-left" ng-i18next="[i18next]({count: numSelectedOptions()})avBooth.questionSelectedOptionsTitle"></h4><avb-selected-options layout=stateData.question.layout max=stateData.question.max min=stateData.question.min sorted=true options=stateData.question.answers><avb-selected-options></avb-selected-options></avb-selected-options></div></div><div class="row hidden" ng-cloak av-affix-bottom=stateData.affixIsSet data-force-affix-width=768><p><span class=text-brand-warning id=selectMoreOptsWarning ng-i18next="[i18next]({min: stateData.question.min})avBooth.selectMoreOpts" ng-if="numSelectedOptions() < stateData.question.min"></span> <span class=text-brand-primary id=maxSelectedLimitReached ng-i18next="[i18next]({max: stateData.question.max})avBooth.maxSelectedLimitReached" ng-if="numSelectedOptions() === stateData.question.max"></span> <span ng-i18next="[i18next]({count: numSelectedOptions()})avBooth.numOptionsSelected" ng-if="numSelectedOptions() !== stateData.question.max && numSelectedOptions() >= stateData.question.min"></span> <span ng-i18next="[i18next]({min:stateData.question.min, max:stateData.question.max})avBooth.numOptionsLimits" ng-if="numSelectedOptions() !== stateData.question.max && numSelectedOptions() >= stateData.question.min"></span></p><button class="btn btn-block btn-lg btn-success btn-plain" ng-i18next=avBooth.continueButton ng-click=questionNext()></button></div></div></div>'),a.put("avBooth/review-ballot-directive/review-ballot-directive.html",'<div class="question padded" ng-repeat="question in election.questions" ng-click="goToQuestion($index, true)"><h3 class=text-brand-success>{{$index + 1}}. {{question.question}}<div class=pull-right><span class="glyphicon glyphicon-edit"></span></div></h3><ul><li ng-repeat="answer in question.answers | avbSelectedOptions" class="animate-repeat selected-answer">{{answer.value}}</li><li ng-if="(question.answers | avbSelectedOptions).length == 0" ng-i18next=avBooth.emptyAnswer></li></ul></div>'),a.put("avBooth/review-screen-directive/review-screen-directive.html",'<nav class="navbar navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"><div class=pull-left ng-i18next="[i18next]({sprintf:[\'3\',\'3\']})avBooth.stepNumber"></div><div class=pull-right><span class="glyphicon glyphicon-question-sign" ng-click=launchHelp()></span></div></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-review-screen #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1 ng-i18next=avBooth.reviewYourBallotTitle></h1><p ng-i18next=avBooth.reviewYourBallotText></p></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content"><div class=container><div class=row><div class=col-xs-12><avb-review-ballot></avb-review-ballot></div></div><div class="row hidden" ng-cloak av-affix-bottom data-force-affix-width=768><button class="btn btn-block btn-lg btn-success btn-plain" ng-i18next=avBooth.encryptAndCastTheBallot ng-click=next()></button></div></div></div>'),a.put("avBooth/selected-options-directive/selected-options-directive.html",'<div class=col-xs-12 ng-if="layout === \'simple\'"><avb-simple-selected-option ng-repeat="option in options | avbSelectedOptions" class=animate-repeat ng-class="{selected: option.selected > -1}" ng-click=toggleSelectItem(option)></avb-simple-selected-option><div class=padded ng-if="(options | avbSelectedOptions).length == 0" ng-i18next=avBooth.noOptionsSelected></div></div><div class=col-xs-12 ng-if="layout === \'accordion\'"><avb-accordion-selected-option ng-repeat="option in options | avbSelectedOptions" class=animate-repeat ng-class="{selected: option.selected > -1}"></avb-accordion-selected-option><div class=padded ng-if="(options | avbSelectedOptions).length == 0" ng-i18next=avBooth.noOptionsSelected></div></div>'),a.put("avBooth/simple-option-directive/simple-option-directive.html",'<span class=show-value>{{option.value}}</span><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div>'),a.put("avBooth/simple-selected-option-directive/simple-selected-option-directive.html",'<span class=show-value>{{option.value}}</span><div class=show-remove><span ng-i18next=avBooth.removeSelectedItem></span> <span class="glyphicon glyphicon-remove"></span></div>'),a.put("avBooth/start-screen-directive/start-screen-directive.html",'<nav class="navbar start-screen navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"><div class=pull-left ng-i18next="[i18next]({sprintf:[\'1\',\'3\']})avBooth.stepNumber"></div><div class=pull-right><span class="glyphicon glyphicon-question-sign" ng-click=launchHelp()></span></div></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-start-screen #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1>{{election.pretty_name}}</h1><p>{{election.description}}</p></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content start-screen"><div class=container><div class=row><div class="padded col-xs-12"><p ng-i18next=avBooth.stepsToVote></p></div></div><div class=row><div class="padded col-xs-12 col-sm-4"><h3 class=text-brand-success ng-i18next=avBooth.selectOptionsTitle></h3><p ng-i18next=avBooth.selectOptionsText></p></div><div class="padded col-xs-12 col-sm-4"><h3 class=text-brand-success ng-i18next=avBooth.reviewOptionsTitle></h3><p ng-i18next=avBooth.reviewOptionsText></p></div><div class="padded col-xs-12 col-sm-4"><h3 class=text-brand-success ng-i18next=avBooth.encryptAndEmitBallotTitle></h3><p ng-i18next=avBooth.encryptAndEmitBallotText></p></div></div><div class="row hidden" ng-cloak av-affix-bottom data-force-affix-width=768><button class="btn btn-block btn-lg btn-success btn-plain" ng-i18next=avBooth.startVoting ng-click=next()></button></div></div></div>'),a.put("avBooth/success-screen-directive/success-screen-directive.html",'<nav class="navbar navbar-default navbar-fixed-top" av-affix-top=.navbar-unfixed-top role=navigation><div class=container><div class="row avb-top-navbar"></div></div></nav><div class=wrapper-unfixed><div class="navbar-unfixed-top text-center" av-collapsing=.unfixed-top-height data-toggle-selector="avb-multi-question #avb-toggle"><div class=container><div class="hidden unfixed-top-height"></div><h1 ng-i18next=avBooth.successTitle></h1><p ng-i18next=avBooth.successSubheader></p></div></div></div><div id=avb-toggle class="text-center item-block hidden"><span class="glyphicon glyphicon-play"></span></div><div class="content avb-content"><div class=container><div class=padded ng-bind-html=successText></div></div></div>'),a.put("test/test_hmac.html",'<div ng-if=hmacIsValid><h2>Hmac is valid!</h2><p>HmacService.hmac(key("{{key}}"), message("{{message}}"))<br>==<br>provided-hmac("{{hmac}}")</p></div><div ng-if=!hmacIsValid><h2>Hmac is NOT valid!</h2><p>HmacService.hmac(key("{{key}}"), message("{{message}}")) =<br>calculated-hmac("{{calculatedHmac}}") != provided-hmac("{{hmac}}")</p></div><h3>Data:</h3><ul><li><strong>key</strong>: "<u>{{key}}</u>"</li><li><strong>message</strong>: "<u>{{message}}</u>" {{messageInvalid}}<br><ul><li><strong>timestamp</strong> (unix timestamp, uint32): "<u>{{timestamp}}</u>" ({{timeago}})</li><li><strong>voter id</strong> (identifies the voter, string): "<u>{{voterId}}</u>"</li><li><strong>election id</strong> (election id, number): "<u>{{electionId}}</u>"</li></ul></li><li><strong>provided hmac</strong>: "<u>{{hmac}}</u>"</li><li><strong>calculated hmac</strong><span ng-if=hmacIsValid>(matches provided hmac!)</span>: "<u>{{calculatedHmac}}</u>"</li></ul>'),a.put("test/unit_test_e2e.html","<div dynamic=html id=dynamic-result></div>")
}]);